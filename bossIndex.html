<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>陆金申华零售业务系统</title>
    <link href="css/ljindex.css" rel="stylesheet" />
    <!-- IE 9以下-->
    <!-- [if lte IE 9 ] >
        <script>
            var newTags=["header","footer","aside","article","canvas","details","figcaption","figure","hgroup","menu","nav","section","summary","time","mark","audio","video"];
            for(var i=0;i<newTags.length;i++){
                document.createElement(newTags[i]);
            }
        </script>
    <![endif]-->

</head>
<body>
<div id="home_container" class="boss_container">
    <div class="content">
        <!-- 待办任务 -->
        <div class="section left_section wait_work">
            <div class="header">
                待办任务
            </div>
            <ul>
                <li class="paragraph">
                    <p>申请提报</p>
                    <span>2</span>
                </li>
                <li class="paragraph">
                    <p>合同信息录入</p>
                    <span>5</span>
                </li>
                <li class="paragraph">
                    <p>合同下载</p>
                    <span>6</span>
                </li>
                <li class="paragraph">
                    <p>请款</p>
                    <span>10</span>
                </li>
            </ul>
        </div>
        <!-- 总统计 -->
        <div class="section center_section boss_count">
            <ul>
                <li class="sum_money">
                    <div>
                        <label>总资产</label>
                        <h3>$<span id="sumOne">300,000.00</span></h3>
                    </div>
                    <p>
                        <span id="perOne">200</span>笔
                    </p>
                </li>
                <li class="back_money">
                    <div>
                        <label>租金回笼量</label>
                        <h3>$<span id="sumTwo">300,000.00</span></h3>
                    </div>
                    <p>
                        <span id="perTwo">66.66</span>%
                    </p>
                </li>
                <li class="expect_num">
                    <div>
                        <label>预期量</label>
                        <h3><span id="sumThree">20</span>笔</h3>
                    </div>
                    <p>
                        <span id="perThree">2</span>%
                    </p>
                </li>
                <li class="recover_car">
                    <div>
                        <label>车辆回收率</label>
                        <h3><span id="sumFour">10辆</span></h3>
                    </div>
                    <p>
                        <span id="perFour">0.1</span>%
                    </p>
                </li>
            </ul>
        </div>
        <!-- 按渠道按车型统计-->
        <div class="section right_section car_count">
            <div id="" class="header tabheader">
                <a class="active" onclick="showTab(event,1)">按渠道统计</a><a onclick="showTab(event,2)">按车型统计</a>
            </div>
            <div class="tabbody">
                <div class="tabpanel" style="height:154px;">
                    <!--渠道统计内容 & 车型统计内容-->

                    <svg  xmlns="http://www.w3.org/2000/svg" width="120px" height="120px" id="circlePic" style="margin: 18px 40px;">
                        <circle r="43" cx="60" cy="60" fill="#fff" id="coverCircle"></circle>
                        <!-- 此处是饼状图-->
                    </svg>
                    <div id="circlePicVml" style="position: absolute; top: 18px; right: 0; bottom: 0; left: 40px;">

                    </div>
                    <div class="center_count">
                        <!-- 饼状图中心区域内容-->
                        <p id="sumNum">0</p>
                        <label for="">总销售量</label>
                    </div>
                    <ul class="count_list" id="countList">
                        <!-- 右侧列表-->
                    </ul>
                </div>
                <div class="tabpanel" style="height:154px;">
                    <!--渠道统计内容 & 车型统计内容-->


                    <svg width="120px" height="120px" id="circlePic2" style="margin: 18px 40px;">
                        <circle r="43" cx="60" cy="60" fill="#fff" id="coverCircle2"></circle>
                        <!-- 此处是饼状图-->
                    </svg>
                    <div id="circlePic2Vml" style="position: absolute; top: 18px; right: 0; bottom: 0; left: 40px;">

                    </div>
                    <div class="center_count">
                        <!-- 饼状图中心区域内容-->
                        <p id="sumNum2">0</p>
                        <label for="">总销售量</label>
                    </div>
                    <ul class="count_list" id="countList2">
                        <!-- 右侧列表-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="content">
        <!-- 经销商TOP10 产品TOP5 -->
        <div class="section left_section rank_panel">
            <div id="11" class="header tabheader">
                <a class="active" onclick="showTab(event,1)">经销商TOP10</a><a onclick="showTab(event,2)">产品TOP5</a>
            </div>
            <div class="tabbody">
                <div class="tabpanel">
                    <!--经销商TOP10内容-->
                    <div class="content">
                        <!-- 排行标尺-->
                        <div class="scale rank_scale">
                            <p style="color:#b2f1a6;">1</p>
                            <p style="color:#a9e7fe;">2</p>
                            <p style="color:#fec8a6;">3</p>
                            <p>4</p>
                            <p>5</p>
                            <p>6</p>
                            <p>7</p>
                            <p>8</p>
                            <p>9</p>
                            <p>10</p>
                        </div>
                        <!-- 右侧名次数量-->
                        <div class="scale number_rank" id="numberRank">
                            <p>3000</p>

                            <p>2400</p>

                            <p>2200</p>

                            <p>1900</p>

                            <p>1780</p>

                            <p>1700</p>

                            <p>1500</p>

                            <p>1100</p>

                            <p>750</p>

                            <p>600</p>
                        </div>
                        <!-- 中间数量虚线-->
                        <div class="scale rank_dashed">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <!-- 底部数量标尺-->
                        <div class="scale number_scale" id="numberScale">
                            <span>600</span><!--
                                --><span>1200</span><!--
                                --><span>1800</span><!--
                                --><span>2400</span><!--
                                --><span>3000</span>
                        </div>
                        <div class="chart">

                            <ul id="chartUl">
                                <li style="width: 250px;background: #b2f1a6;"></li>
                                <li style="width: 220px;background: #a9e7fe;"></li>
                                <li style="width: 200px;background: #fec8a6;"></li>
                                <li style="width: 160px;"></li>
                                <li style="width: 150px"></li>
                                <li style="width: 130px;"></li>
                                <li style="width: 100px;"></li>
                                <li style="width: 80px;"></li>
                                <li style="width: 60px;"></li>
                                <li style="width: 50px;"></li>
                            </ul>
                            <span class="hover_text"></span>
                        </div>

                    </div>

                </div>
                <div class="tabpanel">
                    <!--产品TOP5内容-->
                    <div class="content">
                        <!-- 排行标尺-->
                        <div class="scale rank_scale">
                            <p style="color:#b2f1a6;">1</p>
                            <p style="color:#a9e7fe;">2</p>
                            <p style="color:#fec8a6;">3</p>
                            <p>4</p>
                            <p>5</p>
                        </div>
                        <!-- 右侧名次数量-->
                        <div class="scale number_rank" id="numberRank2">
                            <p>3000</p>
                            <p>2400</p>
                            <p>2200</p>
                            <p>1900</p>
                            <p>1780</p>
                        </div>
                        <!-- 中间数量虚线-->
                        <div class="scale rank_dashed">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <!-- 底部数量标尺-->
                        <div class="scale number_scale" id="numberScale2">
                            <span>600</span><!--
                                --><span>1200</span><!--
                                --><span>1800</span><!--
                                --><span>2400</span><!--
                                --><span>3000</span>
                        </div>
                        <div class="chart">

                            <ul id="chartUl2">
                                <li style="width: 250px;background: #b2f1a6;"></li>
                                <li style="width: 220px;background: #a9e7fe;"></li>
                                <li style="width: 200px;background: #fec8a6;"></li>
                                <li style="width: 160px;"></li>
                                <li style="width: 150px"></li>
                            </ul>

                            <span class="hover_text"></span>
                        </div>

                    </div>

                </div>
            </div>
        </div>
        <!-- 年度申请量 -->
        <div class="section center_section year_apply">
            <div class="header">
                年度申请量
            </div>
            <div class="content">
                <div class="scale money_scale" id="moneyScale">
                    <p>2500</p>

                    <p>2000</p>

                    <p>1500</p>

                    <p>1000</p>

                    <p>500</p>
                </div>
                <!-- 嵌入SVG折线-->
                <svg width="358" height="200" version="1.1"
                     xmlns="http://www.w3.org/2000/svg" style="margin-top: 10px;position: absolute;">

                    <polyline id="polyline" points="0,150 30,140 60,100 90,0 120,40 150,40 180,60 210,60 240,80 270,80 300,100 330,80"
                              style="fill:none;stroke:#fd7676;stroke-width:2"/>
                </svg>
                <div id="polylineVmlDoc" style="margin-top: 10px;">

                </div>
                <div class="chart">
                    <ul id="applyNums">
                        <li style="height: 80px;" data_apply="100" data_month="1"></li>
                        <li style="height: 80px;" data_apply="200" data_month="2"></li>
                        <li style="height: 40px;" data_apply="6,000,000.00" data_month="3"></li>
                        <li style="height: 200px;" data_apply="5,000,000.00" data_month="4"></li>
                        <li style="height: 120px" data_apply="2,000,000.00" data_month="5"></li>
                        <li style="height: 160px;" data_apply="3,000,000.00" data_month="6"></li>
                        <li style="height: 100px;" data_apply="4,000,000.00" data_month="7"></li>
                        <li style="height: 80px;" data_apply="2,200,000.00" data_month="8"></li>
                        <li style="height: 110px;" data_apply="3,400,000.00" data_month="9"></li>
                        <li style="height: 130px;" data_apply="5,000,000.00" data_month="10"></li>
                        <li style="height: 60px;" data_apply="4,900,000.00" data_month="11"></li>
                        <li style="height: 90px;width: 10px;" data_apply="2,090,000.00" data_month="12"></li>
                    </ul>
                    <div class="top_scale" id="applyLineTop"></div>
                    <div class="bottom_scale" id="applyLineBottom"></div>
                    <span class="now_number" id="applyCurrentNum"></span>
                </div>
                <div class="scale month_scale">
                    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>10</span><span>11</span><span>12</span>
                </div>
            </div>

        </div>

        <!-- 年度放款量-->
        <div class="section right_section year_money">
            <div class="header">
                年度放款量
            </div>
            <div class="content">
                <div class="scale money_scale" id="moneyScaleNum">
                    <p>6000万</p>

                    <p>4800万</p>

                    <p>3600万</p>

                    <p>2400万</p>

                    <p>1200万</p>
                </div>
                <div class="chart" id="moneyNums">

                    <ul>
                        <li style="height: 70px;" data_money="1,200,000.00"></li>
                        <li style="height: 80px;" data_money="1,800,000.00"></li>
                        <li style="height: 40px;" class="min" data_money="6,000,000.00"></li>
                        <li style="height: 200px;" class="max" data_money="5,000,000.00"></li>
                        <li style="height: 120px" data_money="2,000,000.00"></li>
                        <li style="height: 160px;" data_money="3,000,000.00"></li>
                        <li style="height: 100px;" data_money="4,000,000.00"></li>
                        <li style="height: 80px;" data_money="2,200,000.00"></li>
                        <li style="height: 110px;" data_money="3,400,000.00"></li>
                        <li style="height: 130px;" data_money="5,000,000.00"></li>
                        <li style="height: 60px;" data_money="4,900,000.00"></li>
                        <li style="height: 90px;" data_money="2,090,000.00"></li>
                    </ul>
                    <div class="top_scale" id="countLineTop"></div>
                    <div class="bottom_scale" id="countLineBottom"></div>
                    <span class="now_number" id="countCurrentNum"></span>
                </div>
                <div class="scale month_scale">
                    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>10</span><span>11</span><span>12</span>
                </div>
            </div>
        </div>

    </div>
</div>
<script>
    if(document.createElementNS){
    }else{
        document.namespaces.add("v", "urn:schemas-microsoft-com:vml");
        var style = document.createStyleSheet();
        var VMLel = ['line','stroke','polyline','fill','oval','arc'];
        for (var i=0,l=VMLel.length;i<l;i++) {
            style.addRule('v\\:'+VMLel[i], "behavior: url(#default#VML);");
        }
    }
    //tab切换
    function showTab(e,num){
        var e = e ? e : window.event;
        var targetEle = e.srcElement || e.target;
        targetEle.className = "active";
        var divList = targetEle.parentNode.parentNode.getElementsByTagName("div");
        var panelList = [];
        for(var i = 0 ; i < divList.length ; i++){
            if(divList[i].className == "tabpanel"){
                panelList.push(i);
            }
        }
        if(num==1){
            divList[panelList[0]].style.display = "block";
            targetEle.parentNode.getElementsByTagName("a")[1].className="";
            divList[panelList[1]].style.display = "none";
        }else{
            divList[panelList[1]].style.display = "block";
            targetEle.parentNode.getElementsByTagName("a")[0].className="";
            divList[panelList[0]].style.display = "none";
        }
    }

    /*
     * 年度申请量赋值
     * 设置折线的样式，12月的json数据 数据格式[200,100,300,40,80,100,220,400,70,120,150,180]
     * 调用例子：setPolyline([500,200,300,40,580,300,220,400,500,120,150,280]);
     *
     */

    setPolyline([500,200,300,40,580,300,220,400,500,120,150,280]);
    function setPolyline(numArr){
        var applyEleArr = document.getElementById("applyNums").getElementsByTagName("li");
        var leftScaleArr = document.getElementById("moneyScale").getElementsByTagName("p");
        var polylineDoc= document.getElementById("polyline");
        var monthObj = {}, maxMonthObj={num:0,monthNum:[]}, minMonthObj={num:0,monthNum:[]};
        var applyLineTop = document.getElementById("applyLineTop");
        var applyLineBottom = document.getElementById("applyLineBottom");
        var applyCurrentNumEle = document.getElementById("applyCurrentNum");

        //初始化月数据对象的申请次数
        for(var i=0 ; i<numArr.length ;i++){
            var num = numArr[i];
            monthObj[i+1] = {
                applyNum: num
            };
        }

        //排序获得最大最小的申请次数
        var sortNumArr =  numArr.sort(function(a,b) {return b-a});
        var unitPoint = 40;//一个格子的高度对应的像素数
        maxMonthObj.num = sortNumArr[0];
        minMonthObj.num = sortNumArr[sortNumArr.length-1];
        //一个格子的高度对应的申请书
        var unitNum = (maxMonthObj.num - minMonthObj.num) /4;
        var proportion = (200 - unitPoint)/(maxMonthObj.num - minMonthObj.num);

        //左侧刻度
        leftScaleArr[0].innerHTML = maxMonthObj.num;
        leftScaleArr[1].innerHTML = maxMonthObj.num - unitNum;
        leftScaleArr[2].innerHTML = maxMonthObj.num - unitNum*2;
        leftScaleArr[3].innerHTML = maxMonthObj.num - unitNum*3;
        leftScaleArr[4].innerHTML = minMonthObj.num;

        //竖直线的高度
        for(onemon in monthObj){
            var monHeight = parseInt((proportion*(monthObj[onemon].applyNum - minMonthObj.num)) + 40); //竖线高度
            applyEleArr[onemon-1].style.height = monHeight + 'px';
            applyEleArr[onemon-1].className = "";
            applyEleArr[onemon-1].setAttribute("data_apply" , monthObj[onemon].applyNum);
            monthObj[onemon].pointHeight = monHeight; //设置竖线高度
            monthObj[onemon].pointY = 200 - monHeight; //设置竖线坐标

            if(monthObj[onemon].applyNum == maxMonthObj.num){
                maxMonthObj.monthNum.push(onemon);
            }
            if(monthObj[onemon].applyNum == minMonthObj.num){
                minMonthObj.monthNum.push(onemon);
            }
            //鼠标移动上去显示月份
            (function(){
                var num = onemon - 1 ;
                applyEleArr[num].onmouseover = function() {
                    applyCurrentNumEle.innerHTML = monthObj[num+1].applyNum;
                    applyCurrentNumEle.style.top = monthObj[num+1].pointY + 'px';
                    //判断是不是最后两个月，设置数据显示在原点前面
                    if(num>9){
                        applyCurrentNumEle.style.left = (30*num-applyCurrentNumEle.clientWidth-6) + 'px';
                    }else{
                        applyCurrentNumEle.style.left = (30*num) + 'px';
                    }

                }
            })();
        }
        var points = "0," + monthObj[1].pointY +
                " 30," + monthObj[2].pointY +
                " 60," + monthObj[3].pointY +
                " 90," + monthObj[4].pointY +
                " 120," + monthObj[5].pointY +
                " 150," + monthObj[6].pointY +
                " 180," + monthObj[7].pointY +
                " 210," + monthObj[8].pointY +
                " 240," + monthObj[9].pointY +
                " 270," + monthObj[10].pointY +
                " 300," + monthObj[11].pointY +
                " 330," + monthObj[12].pointY;
        //设置折线坐标
        if(document.createElementNS){
            //支持SVG
            polylineDoc.setAttribute("points",points);

        }else{
            var polyLineVml = document.createElement("v:polyline");
            polyLineVml.strokeweight = "2px";
            polyLineVml.strokecolor = "#fd7676";
            polyLineVml.points = points;
            document.getElementById("polylineVmlDoc").appendChild(polyLineVml);
        }

        //设置最低最高横线
        applyLineTop.style.width = (maxMonthObj.monthNum[maxMonthObj.monthNum.length - 1] - 1) * 30 + 'px';
        applyLineBottom.style.width = (minMonthObj.monthNum[minMonthObj.monthNum.length - 1] - 1) * 30 + 'px';

        //设置最多次月份颜色
        for(var k = 0 ;k < maxMonthObj.monthNum.length ; k ++ ){
            applyEleArr[maxMonthObj.monthNum[k] - 1 ].className = "max";
        }
        for(var j = 0 ;j < minMonthObj.monthNum.length ; j ++ ){
            applyEleArr[minMonthObj.monthNum[j] - 1 ].className = "min";
        }
    }

    /*
     * 年度放款量赋值
     * 设置折线的样式，12月的json数据 数据格式[200,100,300,40,80,100,220,400,70,120,150,180]
     * 调用例子：setMoneyCount([500,200,300,40,580,300,220,400,500,120,150,280]);
     *
     */
    setMoneyCount([50000,20000,30000,40000,58000,30000,22000,80000,50000,12000,15000,28000]);
    function setMoneyCount(numArr){
        var applyEleArr = document.getElementById("moneyNums").getElementsByTagName("li");
        var leftScaleArr = document.getElementById("moneyScaleNum").getElementsByTagName("p");
        var monthObj = {}, maxMonthObj={num:0,monthNum:[]}, minMonthObj={num:0,monthNum:[]};
        var countLineTop = document.getElementById("countLineTop");
        var countLineBottom = document.getElementById("countLineBottom");
        var CurrentNumEle = document.getElementById("countCurrentNum");

        //初始化月数据对象的申请次数
        for(var i=0 ; i<numArr.length ;i++){
            var num = numArr[i];
            monthObj[i+1] = {
                applyNum: num
            };
        }

        //排序获得最大最小的申请次数
        var sortNumArr =  numArr.sort(function(a,b) {return b-a});
        var unitPoint = 40;//一个格子的高度对应的像素数
        maxMonthObj.num = sortNumArr[0];
        minMonthObj.num = sortNumArr[sortNumArr.length-1];
        //一个格子的高度对应的申请书
        var unitNum = (maxMonthObj.num - minMonthObj.num) /4;
        var proportion = (200 - unitPoint)/(maxMonthObj.num - minMonthObj.num);

        //左侧刻度
        leftScaleArr[0].innerHTML = parseInt(maxMonthObj.num/1000)+'万';
        leftScaleArr[1].innerHTML = parseInt((maxMonthObj.num - unitNum)/1000) + '万';
        leftScaleArr[2].innerHTML = parseInt((maxMonthObj.num - unitNum*2)/1000)+ '万';
        leftScaleArr[3].innerHTML = parseInt((maxMonthObj.num - unitNum*3)/1000) + '万';
        leftScaleArr[4].innerHTML = parseInt(minMonthObj.num/1000)+'万';

        //竖直线的高度
        for(onemon in monthObj){
            var monHeight = parseInt((proportion*(monthObj[onemon].applyNum - minMonthObj.num)) + 40); //竖线高度
            applyEleArr[onemon-1].style.height = monHeight + 'px';
            applyEleArr[onemon-1].className = "";
            applyEleArr[onemon-1].setAttribute("data_apply" , monthObj[onemon].applyNum);
            monthObj[onemon].pointHeight = monHeight; //设置竖线高度
            monthObj[onemon].pointY = 200 - monHeight; //设置竖线坐标

            if(monthObj[onemon].applyNum == maxMonthObj.num){
                maxMonthObj.monthNum.push(onemon);
            }
            if(monthObj[onemon].applyNum == minMonthObj.num){
                minMonthObj.monthNum.push(onemon);
            }
            //鼠标移动上去显示月份
            (function(){
                var num = onemon - 1 ;
                applyEleArr[num].onmouseover = function() {
                    CurrentNumEle.innerHTML = monthObj[num+1].applyNum;
                    CurrentNumEle.style.top = monthObj[num+1].pointY-4 + 'px';
                    //判断是不是最后两个月，设置数据显示在原点前面
                    if(num>9){
                        CurrentNumEle.style.left = (26*(num+1)-CurrentNumEle.clientWidth) + 'px';
                    }else{
                        CurrentNumEle.style.left = 26*(num+1)-8 + 'px';
                    }

                }
            })();
        }

        //设置最低最高横线
        countLineTop.style.width = (maxMonthObj.monthNum[maxMonthObj.monthNum.length - 1]) * 26 + 'px';
        countLineBottom.style.width = (minMonthObj.monthNum[minMonthObj.monthNum.length - 1]) * 26 + 'px';

        //设置最多次月份颜色
        for(var k = 0 ;k < maxMonthObj.monthNum.length ; k ++ ){
            applyEleArr[maxMonthObj.monthNum[k] - 1 ].className = "max";
        }
        for(var j = 0 ;j < minMonthObj.monthNum.length ; j ++ ){
            applyEleArr[minMonthObj.monthNum[j] - 1 ].className = "min";
        }
    }

    //    按渠道／车型统计   传入按照销量排序的数据
    var carcountObj = {
//        渠道统计数据
        channel:{
            arr: [{names:"其他",num:90},{names:"SP",num:300},{names:"经销商",num:800}],
            sumnum: 1190
        },
//        车型统计数据
        carmodel: {
            arr: [{names:"二手车",num:300},{names:"新车",num:700}],
            sumnum: 1000
        }
    };
    setAcr(carcountObj.channel.arr,carcountObj.channel.sumnum,"circlePic","coverCircle","sumNum","countList");
    setAcr(carcountObj.carmodel.arr,carcountObj.carmodel.sumnum,"circlePic2","coverCircle2","sumNum2","countList2");
    function setAcr(arr,sumNum,circlePicId,coverCircleId,sumNumId,countListId){

        var circlePicEle = document.getElementById(circlePicId);
        var coverCircleEle = document.getElementById(coverCircleId);
        var sumNumEle = document.getElementById(sumNumId);
        var countListEle = document.getElementById(countListId);

        var circleObj = {
            cx: 60,
            cy: 60,
            cr: 60
        };
        var apaths = [];
        var rotateSum = 0;
        sumNumEle.innerHTML = sumNum;
        for(var i = 0 ;i <arr.length ; i ++ ){

            rotateSum+=(arr[i].num/sumNum)*360;;
            apaths.push({
                names: arr[i].names,
                num: arr[i].num,
                mx: i==0 ? 60 : apaths[i-1].pathx,
                my: i==0 ? 0 : apaths[i-1].pathy,
                pathx: i==0 ? circleObj.cx + circleObj.cr*Math.sin(arr[i].num/sumNum*2*Math.PI) : circleObj.cx + circleObj.cr*Math.sin((arr[i].num/sumNum+apaths[i-1].rotate)*2*Math.PI),
                pathy : i==0 ? circleObj.cy + circleObj.cr*(Math.cos(arr[i].num/sumNum*2*Math.PI))*-1 : circleObj.cy + circleObj.cr*Math.cos((arr[i].num/sumNum+apaths[i-1].rotate)*2*Math.PI)*-1,
                isBigArc : arr[i].num/sumNum*360>180 ? 1: 0,
                rotate: rotateSum/360,
                rotateArc: rotateSum,
                percent: arr[i].num/sumNum
            });
            var curPath = apaths[apaths.length-1];
            var pathColor = "#ddd";
            switch (i%10){
                case 0:
                    pathColor = "#fda9a4"
                    break;
                case 1:
                    pathColor = "#fe9696"
                    break;
                case 2:
                    pathColor = "#b0efc0"
                    break;
                case 3:
                    pathColor = "#e7efb0"
                    break;
                case 4:
                    pathColor = "#efd7b0"
                    break;
                case 5:
                    pathColor = "#a9dffe"
                    break;
                default:
                    pathColor = "#ddd"
            }


            if(i == arr.length-1){
                pathColor = "#81edac";
            }else if(i == arr.length-2){
                pathColor = "#a9e7fe";
            }else if(i == arr.length-3) {
                pathColor = "#fec8a6";
            }else{

            }
            if(document.createElementNS){
                //支持SVG的
                var newPath = document.createElementNS('http://www.w3.org/2000/svg',"path");

                newPath.setAttribute("d","M " + curPath.mx + " " + curPath.my +" A 60 60 "+ 0  +" "+ curPath.isBigArc +" 1 "+curPath.pathx+" "+curPath.pathy+" L 60 60 Z");
                newPath.setAttribute("stroke", "#fff");
                newPath.setAttribute("data-text",curPath.names);
                newPath.setAttribute("fill", pathColor);
                newPath.setAttribute("data-num",curPath.num);
                newPath.setAttribute("data-precent",curPath.percent*100+'%');
                circlePicEle.insertBefore(newPath,coverCircleEle);
            }else{
                //不支持SVG，使用VML
                var circlePicVmlEle = document.getElementById(circlePicId+"Vml");
                var newPathVml = document.createElement("v:Arc");

                newPathVml.setAttribute("Filled",false);
                newPathVml.setAttribute("StartAngle",parseInt(curPath.rotateArc-curPath.num/sumNum*360));

                newPathVml.setAttribute("EndAngle",parseInt(curPath.rotateArc));
                newPathVml.strokecolor = pathColor;
                newPathVml.strokeweight = "14pt";
                newPathVml.setAttribute("style","position:absolute; top:8px;left:8px;");
                newPathVml.style.width = "108";
                newPathVml.style.height = "108";
                circlePicVmlEle.appendChild(newPathVml);
            }
            //右侧列表
            (function(){
                var newLiEle = document.createElement("li");
                var spanPrecentEle = document.createElement("span");
                var spanNamesEle = document.createElement("span");
                var spanNumEle = document.createElement("span");
                spanPrecentEle.className = "count_precent";
                spanNamesEle.className = "count_names";
                spanNumEle.className = "count_names";
                spanPrecentEle.style.background = pathColor;
                spanPrecentEle.innerHTML = (curPath.percent*100*10000/10000).toFixed(2) + '%';
                spanNamesEle.innerHTML = curPath.names+": ";
                spanNumEle.innerHTML = curPath.num;
                newLiEle.appendChild(spanPrecentEle);
                newLiEle.appendChild(spanNamesEle);
                newLiEle.appendChild(spanNumEle);
                countListEle.insertBefore(newLiEle,countListEle.firstChild);
            })();

        }

    }

    //    中间区域统计数据回显{sumcount:{num:300000,per:200},backmoney:{num:300000,per:66.66%},expectnum:{num:20,per:1},recovercar:{num:10,per:0.1}}
    setSumcount({sumcount:{num:300000,per:200},backmoney:{num:300000,per:"66.66"},expectnum:{num:20,per:1},recovercar:{num:10,per:0.1}});
    function setSumcount(obj){
        document.getElementById("sumOne").innerHTML = obj.sumcount.num;
        document.getElementById("perOne").innerHTML = obj.sumcount.per;
        document.getElementById("sumTwo").innerHTML = obj.backmoney.num;
        document.getElementById("perTwo").innerHTML = obj.backmoney.per;
        document.getElementById("sumThree").innerHTML = obj.expectnum.num;
        document.getElementById("perThree").innerHTML = obj.expectnum.per;
        document.getElementById("sumFour").innerHTML = obj.recovercar.num;
        document.getElementById("perFour").innerHTML = obj.recovercar.per;
    }

    //    经销商TOP10 产品TOP5 {company:{num1:{names:"XX公司",num:3000},....},product:{num1:{names:"XX产品",num:2000},....}}
    var topData = {
        company: {
            num1: {names:"XX公司1",num:3000},
            num2: {names:"XX公司2",num:2400},
            num3: {names:"XX公司3",num:2200},
            num4: {names:"XX公司4",num:1900},
            num5: {names:"XX公司5",num:1780},
            num6: {names:"XX公司6",num:1700},
            num7: {names:"XX公司7",num:1500},
            num8: {names:"XX公司8",num:1100},
            num9: {names:"XX公司9",num:750},
            num10: {names:"XX公司10",num:500}
        },
        product: {
            num1: {names:"XX产品1",num:3000},
            num2: {names:"XX产品2",num:2400},
            num3: {names:"XX产品3",num:2000},
            num4: {names:"XX产品4",num:1500},
            num5: {names:"XX产品5",num:800}
        }
    };

    //    设置经销商TOP10 产品TOP5
    setTopCount(topData.company,"chartUl","numberRank","numberScale",10);
    setTopCount(topData.product,"chartUl2","numberRank2","numberScale2",5);
    function setTopCount(objchild,companyEleId,numberRankEleId,numberScaleEleId,topNum){
        var liList = document.getElementById(companyEleId).getElementsByTagName("li");//条状的li数组
        var numberRankList = document.getElementById(numberRankEleId).getElementsByTagName("p");//右侧li的销售量
        var numberScaleList = document.getElementById(numberScaleEleId).getElementsByTagName("span");//底部的刻度

        var maxNum = objchild.num1.num;
        var minNum = objchild["num"+topNum].num;
        var bottomUnit = (maxNum-minNum)/4;
        var unitPoint = 50/bottomUnit;

        //    设置底部刻度
        for(var i = 0 ;i < 5 ; i ++ ){
            numberScaleList[i].innerHTML = minNum + bottomUnit*i;
        }
        //    设置右侧刻度
        for(var j = 0 ;j < topNum ; j ++ ){
            numberRankList[j].innerHTML = objchild["num"+(j+1)].num;
            liList[j].setAttribute("data-text",objchild["num"+(j+1)].names);
            liList[j].style.width = (parseInt((objchild["num"+(j+1)].num-minNum)*unitPoint) + 50) +'px';
            liList[j].className = "";
            (function(){
               var curnum =  j;
                liList[j].onmouseover = function(){
                    var textEle = document.getElementById(companyEleId).parentNode.getElementsByTagName("span")[0];
                    textEle.innerHTML = objchild["num"+(curnum+1)].names;
                    if(topNum == 10){
                        textEle.style.top = ((curnum+1)*20-10) +"px";
                    }else{
                        textEle.style.top = ((curnum+1)*40-20) +"px";
                    }
                }

            })()
        }
    }
</script>
</body>
</html>